# Source: groundcover-wrapper/charts/groundcover/charts/clickhouse/templates/configmap-users-extra.yaml
apiVersion: v1
kind: ConfigMap
metadata:
  name: groundcover-clickhouse-users-extra
  namespace: groundcover
  labels:
    app.kubernetes.io/instance: groundcover
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/name: clickhouse
    app.kubernetes.io/version: 24.10.1
    helm.sh/chart: clickhouse-6.3.1
    app.kubernetes.io/component: clickhouse
data:
  01_users_extra_overrides.xml: |
    <clickhouse>
      <profiles>
        <reader_profile>
          <readonly>2</readonly>
        </reader_profile>
        <writer_profile>
          <readonly>0</readonly>
        </writer_profile>
      </profiles>
      <users>
        <default>
          <default_database>groundcover</default_database>
        </default>
        <manager>
          <default_database>default</default_database>
          <password from_env="CLICKHOUSE_PASSWORD" />
          <networks>
            <ip>::/0</ip>
          </networks>
        </manager>
        <reader>
          <password from_env="CLICKHOUSE_PASSWORD" />
          <networks>
            <ip>::/0</ip>
          </networks>
          <profile>reader_profile</profile>
          <quota>default</quota>
        </reader>
        <writer>
          <password from_env="CLICKHOUSE_PASSWORD" />
          <networks>
            <ip>::/0</ip>
          </networks>
          <profile>writer_profile</profile>
          <quota>default</quota>
        </writer>
      </users>
    </clickhouse>
