## Generated by:
# 1. using simple cli install
# 2. helm get values groundcover
# 3. move token into AWS secret -> ExternalSecret
# https://docs.groundcover.com/getting-started/installation-and-updating/connect-kubernetes-cluster#self-managed
groundcover:
  agent:
    sensor:
      resources:
        limits:
          memory: 1Gi
        requests:
          memory: 1Gi
    tolerations: []
  backend:
    keep:
      backend:
        resources:
          requests:
            cpu: 100m
            memory: 128Mi
        databaseConnectionStringFromSecret:
          enabled: true
          secretName: keep-postgres
          secretKey: connection_string
        ###################
        # NOTE: We are creating keep-credentials out of band (via external secret)
        #       and are using the same secret name + keys as the
        #       autogenerated secret. We dont set the env here to
        #       avoid wiping out the rest of the default env block
        #       https://github.com/groundcover-com/helm-charts/blob/450b6a3412def907e5ba27d0908e87945fd80ea5/charts/groundcover/charts/backend/values.yaml#L202-L284
        ##################
        # env:
        #   - name: KEEP_DEFAULT_API_KEYS
        #     secretKeyRef:
        #       secretName: keep-credentials
        #       secretKey: api-keys
        ###################
    postgresql:
      primary:
        resources:
          limits:
            memory: 60Mi
          requests:
            cpu: 5m
            memory: 40Mi
      #######################
      # NOTE: We are creating keep-postgres out of band (via external secret)
      #       and are using the same secret name + keys as the
      #       autogenerated secret. We dont set the env here to
      #       avoid wiping out the rest of the default extraEnvVars block
      #       https://github.com/groundcover-com/helm-charts/blob/450b6a3412def907e5ba27d0908e87945fd80ea5/charts/groundcover/charts/backend/values.yaml#L46C2-L57
      ##################
      # extraEnvVars:
      #   - name: POSTGRES_KEEP_PASSWORD
      #     valueFrom:
      #       secretKeyRef:
      #         optional: true
      #         name: keep-postgres
      #         key: password

      auth:
        existingSecret: groundcover-postgresql
        secretKeys:
          adminPasswordKey: "postgres-password"

      tls:
        enabled: true
        # We handle PKI with cert manager to avoid commiting secrets
        autoGenerated: false
        certificatesSecret: groundcover-postgresql-crt
        certFilename: tls.crt
        certKeyFilename: tls.key
        # # NOTE: CA file not defined when generated by helm w/ default values
        # certCAFilename: ca.crt

  # clickhouse:
  #   auth:
  #     existingSecret: # override global.clickhouse.auth.existingSecret to use exisiting secret

  commitHashKeyName: ""
  custom-metrics:
    resources:
      limits:
        memory: 256Mi
      requests:
        cpu: 50m
        memory: 64Mi

  global:
    clickhouse:
      auth:
        existingSecret: groundcover-clickhouse
        existingSecretKey: admin-password

    groundcoverPredefinedTokenSecret:
      secretName: groundcover-token
      secretKey: token

    workflows:
      adminApiKey: admin-foobarbaz
      webHookApiKey: webhook-foobarbaz

  installationId: 621835c9-599e-4167-bb7f-e77d0ce77b92
  k8sWatcher:
    resources:
      limits:
        cpu: 500m
        memory: 1024Mi
      requests:
        cpu: 10m
        memory: 256Mi
  metrics-ingester:
    resources:
      limits:
        memory: 512Mi
      requests:
        cpu: 50m
        memory: 256Mi
    extraVolumes:
      - name: certificate
        secret:
          optional: true
          secretName: metrics-ingester-certificate
    extraVolumeMounts:
      - name: certificate
        readOnly: true
        mountPath: /etc/ssl/gc-certs

  monitors-manager:
    resources:
      limits:
        memory: 150Mi
      requests:
        cpu: 5m
        memory: 110Mi
    admin:
      existingSecret: groundcover-monitors-manager
      userKey: admin-user
      passwordKey: admin-password

  opentelemetry-collector:
    resources:
      limits:
        memory: 2048Mi
      requests:
        cpu: 50m
        memory: 256Mi
  portal:
    resources:
      limits:
        memory: 128Mi
      requests:
        cpu: 5m
        memory: 64Mi
  repositoryUrlKeyName: ""
  storeIssuesLogsOnly: false
  vector:
    replicas: 1
    resources:
      limits:
        memory: 1024Mi
      requests:
        cpu: 50m
        memory: 256Mi
  victoria-metrics-agent:
    resources:
      limits:
        memory: 256Mi
      requests:
        cpu: 16m
        memory: 32Mi
  victoria-metrics-single:
    server:
      resources:
        limits:
          memory: 1024Mi
        requests:
          cpu: 20m
          memory: 128Mi
