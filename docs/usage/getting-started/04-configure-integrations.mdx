---
title: 'Configure Integrations'
description: 'Configure AWS, GitHub, and Terramate Cloud integrations'
icon: 'link'
---

## Overview

After [bootstrapping your accounts](/usage/getting-started/03-bootstrap-accounts), you need to configure the external service integrations that enable CI/CD automation. This page covers:

- **AWS**: Account IDs and role ARNs for Terraform
- **GitHub (octo-sts)**: Tokens for managing GitHub organization resources
- **Terramate Cloud** (optional): Plan visualization and drift detection

<Warning>
Complete [Bootstrap Accounts](/usage/getting-started/03-bootstrap-accounts) before this step. You need the actual AWS account IDs and role ARNs that were created during bootstrapping.
</Warning>

## What You Need

After bootstrapping, you should have:

| Value | Where It Comes From |
|-------|---------------------|
| Infrastructure account ID | AWS Console or `aws sts get-caller-identity` |
| GitHub OIDC role ARN | Created in bootstrap Step 3 |
| SSO admin role ARN | Retrieved in bootstrap Step 1 |
| S3 state bucket name | Created in bootstrap Step 1 |

## Update Terraform Configuration

Edit `terraform/config.tm.hcl` with your actual AWS values:

```hcl
globals {
  namespace = "acme"  # Already set during repository setup

  # GitHub OIDC role ARN (created during bootstrap)
  github_oidc_assume_role_arn = "arn:aws:iam::123456789012:role/acme-gbl-infra-bootstrap-github-oidc"

  # SSO admin role ARN (from AWS IAM Identity Center)
  sso_admin_assume_role_arn = "arn:aws:iam::123456789012:role/aws-reserved/sso.amazonaws.com/us-east-2/AWSReservedSSO_AdministratorAccess_abc123"

  # S3 backend configuration (created during bootstrap)
  backend_bucket = "acme-gbl-infra-bootstrap-state"
  backend_region = "us-east-2"

  # Provider versions (update as needed)
  terraform = {
    version = "~> 1.6"
    providers = {
      aws = {
        source  = "hashicorp/aws"
        version = "6.27.0"
        enabled = true
      }
      random = {
        source  = "hashicorp/random"
        version = "~> 3.0"
        enabled = false
      }
    }
  }
}
```

## Update GitHub Workflows

Update the AWS role ARN in `.github/workflows/terramate-preview.yml` and `.github/workflows/terramate-deploy.yml`:

```yaml
- name: "Configure AWS Credentials"
  uses: aws-actions/configure-aws-credentials@v4
  with:
    aws-region: us-east-2
    role-to-assume: arn:aws:iam::123456789012:role/acme-gbl-infra-bootstrap-github-oidc
```

## Configure octo-sts for GitHub Tokens

The Terramate workflows use [octo-sts](https://github.com/octo-sts/app) to obtain GitHub tokens for managing GitHub organization resources (teams, members, repository settings). This is more secure than storing long-lived GitHub tokens as secrets.

<Steps>
  <Step title="Install the octo-sts GitHub App">
    1. Navigate to the [octo-sts GitHub App](https://github.com/apps/octo-sts)
    2. Click **Install** and select your organization
    3. Grant access to your forked repository (or all repositories)
  </Step>

  <Step title="Update trust policy files">
    Update each policy file in `.github/chainguard/` to reference your organization:

    **`.github/chainguard/terramate.sts.yaml`**:

    ```yaml
    issuer: https://token.actions.githubusercontent.com
    subject_pattern: ^repo:YOUR-ORG/kube-starter-kit:.*
    claim_pattern:
      workflow_ref: '^YOUR-ORG/kube-starter-kit/\.github/workflows/terramate.*@refs/.*$'

    permissions:
      administration: write
      metadata: read
      members: write
      contents: read
    ```

    **`.github/chainguard/release-please.sts.yaml`**:

    ```yaml
    issuer: https://token.actions.githubusercontent.com
    subject: repo:YOUR-ORG/kube-starter-kit:ref:refs/heads/main

    permissions:
      contents: write
      pull_requests: write
    ```

    Replace `YOUR-ORG` with your GitHub organization name.
  </Step>
</Steps>

## Configure Terramate Cloud (Optional)

If you want to use [Terramate Cloud](https://cloud.terramate.io/) for plan visualization and drift detection:

1. Create an account at [cloud.terramate.io](https://cloud.terramate.io/)
2. Install the GitHub App from your Terramate Cloud dashboard under **Integrations** to enable PR comments and status checks
3. Update the `cloud_organization` in `.github/workflows/terramate-preview.yml` and other Terramate workflows:

```yaml
- name: Install Terramate
  uses: terramate-io/terramate-action@0500f8a40b57a793a41edd2aea0a49e31c7204e8 # v3.2.0
  with:
    version: "0.15.1"
    cloud_organization: your-terramate-org
```

<Tip>
Terramate Cloud is optional but recommended. It provides a unified view of Terraform plans across all stacks and makes PR reviews much easier.
</Tip>

## Search for Remaining References

Search for any remaining references to the original organization or AWS accounts:

```bash
# Find references to the original organization
grep -r "DevOps-Directive" .github/
grep -r "094905625236" .  # Original AWS account ID
```

<Tip>
The `docs/docs.json` file contains GitHub links for the documentation site. Update these if you're keeping the docs.
</Tip>

## Verify Your Setup

```bash
cd terraform
terramate fmt --check
terramate generate
```

Review the generated files to ensure your configuration changes propagated correctly.

## Commit Your Changes

```bash
git add .
git commit -m "chore: configure AWS account IDs and role ARNs"
git push
```

## Verify CI/CD

Push a commit or open a pull request to verify that GitHub Actions can authenticate to AWS:

1. Check the workflow run in the **Actions** tab
2. The `Configure AWS Credentials` step should succeed
3. Terraform plan output should appear (if using Terramate Cloud, check the PR comments)

## Next Steps

With AWS integration configured, you're ready to [Deploy Infrastructure](/usage/getting-started/05-deploy-infrastructure) to provision networking and EKS clusters.
